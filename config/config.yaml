# config.yaml
# Parametri configurabili pentru PDF-to-Embedding pipeline
#
# Utilizare în Python:
#   import yaml
#   with open('config/config.yaml') as f:
#       config = yaml.safe_load(f)
#   chunk_size = config['pdf']['chunk_size']

# ============================================================================
# PDF PROCESSING SETTINGS
# ============================================================================
pdf:
  # Text chunking
  chunk_size: 500        # Lungimea țintă a unui chunk (caractere)
  overlap: 50            # Caractere care se repetă între chunks (pentru context)
  min_chunk_length: 50   # Chunk-uri mai mici decât asta sunt ignorate

  # Filtrare
  remove_duplicates: true  # Elimina header/footer duplicates (via MD5 hash)
  skip_empty_pages: true   # Sari peste pagini fără text

# ============================================================================
# OCR (OPTICAL CHARACTER RECOGNITION) SETTINGS
# ============================================================================
ocr:
  # Activare
  enabled: false         # Procesează imagini cu OCR? (DISABLED pentru rulare fără PaddleOCR)

  # Limbi
  languages:
    - 'ro'               # Limba română (prioritate 1)
    - 'en'               # Engleză (prioritate 2 pentru cuvinte internaționale)

  # Filtrare imagini
  min_image_size: 51200  # Minim 50KB pentru o imagine să fie procesată
  priority_threshold: 0.8  # Doar imagini cu priority >= 0.8 sunt procesate cu OCR
                           # (diagrame/exerciții, nu decorative)

  # Confidence
  min_confidence: 0.5    # Minim confidence score pentru a include text din OCR

  # GPU
  use_gpu: false         # PaddleOCR GPU? False = CPU (mai stabil pe Kaggle)

# ============================================================================
# EMBEDDINGS SETTINGS
# ============================================================================
embeddings:
  # Model
  model: "paraphrase-multilingual-mpnet-base-v2"  # Multilingual BERT model
  # Alte opțiuni:
  # - "paraphrase-MiniLM-L6-v2" (mai mic, mai rapid, mai puțin acurat)
  # - "all-mpnet-base-v2" (engleză optimizată)
  # - "distiluse-base-multilingual-cased-v2" (mai mic)

  # Processing
  batch_size: 128        # Texte procesate pe o dată (GPU: 128-256, CPU: 32-64)
  dimensions: 768        # Output dimensiuni (768 pentru paraphrase-mpnet)

  # Device
  device: "cpu"          # "cpu" (default, stabil) sau "cuda" (GPU dacă disponibil)

  # Normalize
  normalize: true        # Normalize embeddings la unit length

# ============================================================================
# SUPABASE SETTINGS
# ============================================================================
supabase:
  # Table name (default, don't change unless schema modified)
  table_name: "document_embeddings"

  # Batch upload
  batch_size: 10000      # Vectori per batch insert (10k = ~15-30 secunde)
  max_retries: 3         # Retry attempts per batch failed
  retry_delay: 5         # Delay între retries (secunde)

  # Indexing
  create_hnsw_index: true  # Crează HNSW index post-upload? (improve query speed)
  hnsw_m: 16            # HNSW parameter M (16 = good balance)
  hnsw_ef: 64           # HNSW parameter EF_CONSTRUCTION

# ============================================================================
# PROCESSING PIPELINE SETTINGS
# ============================================================================
pipeline:
  # Logging
  log_level: "INFO"      # "DEBUG", "INFO", "WARNING", "ERROR"
  log_file: "logs/processing.log"  # Path pentru log file

  # Checkpoints
  checkpoint_every: 50   # Salvează progress la fiecare N PDFs procesate
  checkpoint_dir: "checkpoints/"

  # Resume
  resume_from_checkpoint: false  # Resume din checkpoint dacă procesul fail?

  # Progress
  show_progress_bars: true  # Afișează progress bars (tqdm)?
  update_interval: 1     # Update interval pentru progress (secunde)

# ============================================================================
# EDUCATIONAL METADATA
# ============================================================================
metadata:
  # Clasele educaționale
  classes: [0, 1, 2, 3, 4]

  # Materiile (exemple)
  subjects:
    - "Matematică"
    - "Limba Română"
    - "Știința"
    - "Istorie"
    - "Geografie"
    - "Educație Fizică"
    - "Arte Plastice"
    - "Muzică"

# ============================================================================
# OPTIMIZATION SETTINGS
# ============================================================================
optimization:
  # Memory optimization
  clear_embeddings_after_upload: true  # Delete embeddings from RAM după upload
  garbage_collect_interval: 100        # Forța garbage collection la fiecare N items

  # Parallel processing
  num_workers: 4         # Worker threads pentru I/O (PDF reading, etc)
  use_multiprocessing: true  # Use multiprocessing (vs threading)?

  # Caching
  cache_models: true     # Salvează modele după download (nu re-download)
  cache_dir: ".cache/"

# ============================================================================
# DEVELOPMENT / DEBUG
# ============================================================================
debug:
  test_mode: false       # Procesează doar 10 PDFs? (pentru testing)
  verbose: false         # Arată mai multe detalii?
  save_intermediate: false  # Salvează intermediary results (chunks, embeddings)?

# ============================================================================
# NOTES
# ============================================================================
# - Valorile default sunt optimizate pentru Kaggle P100 GPU + 15GB PDFs
# - Pentru laptop local: reduce batch_size la 32, use_gpu: false
# - Pentru GPU PC: batch_size pote crește la 256, use_gpu: true
# - chunk_size: 500 e bun pentru semantic similarity, 200-300 pentru mai mult detail
# - priority_threshold: 0.8 skip imagini decorative, 0.5 include toate imagini
# ============================================================================
